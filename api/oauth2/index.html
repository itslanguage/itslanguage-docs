<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OAuth2 - ITSLanguage API</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "OAuth2";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="icon icon-home"> ITSLanguage API</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <ul class="subnav">
    <li><span>Home</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../index.html">ITSLanguage Speech API</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>REST API basics</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../index.html">The REST API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../authentication/index.html">Authentication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../permissions/index.html">Roles and Permissions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../errors/index.html">Error handling</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>REST API</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="index.html">OAuth2</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#tenant-server-authentication">Tenant server authentication</a></li>
                
                    <li><a class="toctree-l4" href="#obtain-access-token">Obtain access token</a></li>
                
                    <li><a class="toctree-l4" href="#using-the-access-token">Using the access token</a></li>
                
            
                <li class="toctree-l3"><a href="#tenant-client-authentication">Tenant client authentication</a></li>
                
                    <li><a class="toctree-l4" href="#student-level">Student level</a></li>
                
                    <li><a class="toctree-l4" href="#organisation-level">Organisation level</a></li>
                
                    <li><a class="toctree-l4" href="#tenant-level">Tenant level</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../organisations/index.html">Organisations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../students/index.html">Students</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../challenges/index.html">Challenges</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../recordings/index.html">Speech Recordings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../analyses/index.html">Speech Analysis</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../recognitions/index.html">Speech Recognition</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Websocket API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../websocket/index.html">Websocket API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../websocket/speech_recording/index.html">Speech Recording</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../websocket/pronunciation_analyses/index.html">Pronunciation Analyses</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../websocket/choice_recognitions/index.html">Choice Recognitions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../websocket/audio/index.html">Audio</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Internal API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../permissions/index.html">Permissions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../architecture/index.html">Infrastructure Architecture</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ITSLanguage API</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
    
      
        
          <li>REST API &raquo;</li>
        
      
    
    <li>OAuth2</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="tenant-server-authentication"><a class="toclink" href="#tenant-server-authentication">Tenant server authentication</a></h1>
<p>OAuth2 is implemented so a tenant may authenticate and request an access
token. Access tokens may be distributed to end-users to grant them access. By
using access tokens, access may be restricted by using scopes.</p>
<p>Each tenant will receive a set of secrets called principal and credentials.
The principal is a unique identifier (like a username) and the credentials are
a secret, only the tenant should know (a password). A tenant can authenticate
and receive an access token using these secrets.</p>
<p>An access token can be used to make an authorised request. To do so, the
access token should be passed as an authorization request header.</p>
<h2 id="obtain-access-token"><a class="toclink" href="#obtain-access-token">Obtain access token</a></h2>
<p>An access token can either be requested using a manual request or by using an
OAuth2 compatible client.</p>
<h3 id="request"><a class="toclink" href="#request">Request</a></h3>
<p>To request an access token, a POST request should be done to the access token
API. The body should contain the username, password, grant type and optional
scope. Example, to request an access token for the user <code>tenant</code> with password
<code>secret</code> and scope <code>tenant/tenant</code>:</p>
<pre><code class="http">POST https://api.itslanguage.nl/tokens HTTP/1.1
Accept: application/x-www-form-urlencoded

grant_type=password&amp;username=tenant&amp;password=secret&amp;scope=tenant%2Ftenant
</code></pre>

<p>Note the <code>Content Type</code> of the POST.</p>
<h3 id="response"><a class="toclink" href="#response">Response</a></h3>
<pre><code class="http">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
    &quot;access_token&quot;: &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.e30.nxowLE6zdaUjmiZKP-9K8OaXGUM_6O7LuHgUZgyAY9c&quot;,
    &quot;token_type&quot;: &quot;Bearer&quot;,
    &quot;scope&quot;: &quot;tenant/tenant&quot;
}
</code></pre>

<h2 id="using-the-access-token"><a class="toclink" href="#using-the-access-token">Using the access token</a></h2>
<p>The access token can be used to make an authorised request. To do so, the
access token should be placed in the Authorization header as a bearer token.
Example:</p>
<pre><code class="http">GET https://api.itslanguage.nl/organisations HTTP/1.1
Accept: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.e30.nxowLE6zdaUjmiZKP-9K8OaXGUM_6O7LuHgUZgyAY9c
</code></pre>

<h1 id="tenant-client-authentication"><a class="toclink" href="#tenant-client-authentication">Tenant client authentication</a></h1>
<p>Instead of sharing the tenant's principal and credentials, a tenant client
should request or receive an access token from the tenant server. This should
usually happen when an end-user logs into the tenant server. How this is done
is to be determined by the tenant. This access token can be used by the client
to authenticate on behalf of the tenant at the REST API or the Websocket
server. By issuing the access token to a tenant client, the tenant server
grants the tenant client access to the ITSLanguage platform.</p>
<p>In order to dispense an access token to the tenant client, the tenant server
should request a token from the REST API. A token can be requested at three
levels, tenant level, organisation level or student level.</p>
<h2 id="student-level"><a class="toclink" href="#student-level">Student level</a></h2>
<p>This is the recommended way to request an access token. This way the access
token is bound to a specific student so the token can only be used by that
student. The tenant server should request an access token with a special
scope. A student scope for the student <code>joe</code> in organisation <code>org</code> owned by
tenant <code>tenant</code> should look like this:
<code>tenant/tenant/organisation/org/student/joe</code></p>
<p>This method should be used in production as it is the most secure method. It
provides isolation at student level. This means that each student receives a
different access token. Students cannot access another student's data.</p>
<h2 id="organisation-level"><a class="toclink" href="#organisation-level">Organisation level</a></h2>
<p>Using this method, an access token is issued for an organisation. This access
token can be used by each student in that organisation. All students in that
organisation make use of the same account (dummy). This also means that
students have access to each others data.</p>
<p>When this method is chosen, a dummy student is created so the access token can
be used. When an API call requires a student, the id <code>dummy</code> needs to be
supplied.</p>
<p>To create an organisation level access token for the organisation <code>org</code> owned
by the tenant <code>tenant</code>, the scope should be <code>tenant/tenant/organisation/org</code>.</p>
<h2 id="tenant-level"><a class="toclink" href="#tenant-level">Tenant level</a></h2>
<p>A tenant level access token can be requested to perform administrational tasks
like creating organisations. It is also possible to perform analyses on
behalf of the tenant. There is no distinction between organisations or students
so <strong>all</strong> students of all organisations within that tenant use the same
account.</p>
<p>To make this work, a dummy organisation and a dummy student are created. When
an API call requires an organisation or a student, the id <code>dummy</code> can be given
for the organisation and the student.</p>
<p>To create a tenant level access token for the tenant <code>tenant</code> the scope should
be <code>tenant/tenant</code>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../organisations/index.html" class="btn btn-neutral float-right" title="Organisations"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../errors/index.html" class="btn btn-neutral" title="Error handling"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>2013-2015</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../errors/index.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../organisations/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
